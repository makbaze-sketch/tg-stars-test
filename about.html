<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>Qleweta ‚Äî –°—Ç–∞—Ç—É—Å ¬∑ –ú–∞–≥–∞–∑–∏–Ω ¬∑ –ü–µ—Å–æ—á–Ω–∏—Ü–∞</title>
<meta name="color-scheme" content="dark light">
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
/* =====================================================================
   QLEWETA MINI‚ÄëAPP ‚Äî MOBILE PRO (single file)
   ---------------------------------------------------------------------
   –¶–µ–ª–∏:
   ‚Ä¢ –°–∏–ª—å–Ω–∞—è –º–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è (iOS/Android, –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ —Ö–∏—Ç—ã, safe-area)
   ‚Ä¢ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram WebApp API (MainButton, BackButton, Haptics, theme)
   ‚Ä¢ 5 —Ä–∞–∑–¥–µ–ª–æ–≤: –°—Ç–∞—Ç—É—Å, –ú–∞–≥–∞–∑–∏–Ω, –ü—Ä–æ—Ñ–∏–ª—å, –ü–µ—Å–æ—á–Ω–∏—Ü–∞, FAQ/–°–ø—Ä–∞–≤–∫–∞
   ‚Ä¢ –ú–∞–≥–∞–∑–∏–Ω —Å –ø–∞–∫–µ—Ç–∞–º–∏ Stars ‚Üí sendData("buy_XX") –∏ –º—è–≥–∫–∏–π UX –∑–∞–∫—Ä—ã—Ç–∏—è
   ‚Ä¢ –ß–∏—Å—Ç—ã–π –¥–∏–∑–∞–π–Ω (glass+glow), –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å, –ø–ª–∞–≤–Ω–æ—Å—Ç—å, –Ω–∏–∑–∫–∏–π –≤–µ—Å
   ‚Ä¢ –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è RU/EN (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å)
   ‚Ä¢ –¢–æ—Å—Ç—ã, –æ—Ñ—Ñ–ª–∞–π–Ω-–¥–µ—Ç–µ–∫—Ç, —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ö–µ–ª–ø–µ—Ä—ã, –ª–æ–≥–≥–µ—Ä
   ‚Ä¢ –ú–Ω–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ —Ä–æ—Å—Ç–∞ (—Ñ–∞–π–ª >1000 —Å—Ç—Ä–æ–∫)
   ---------------------------------------------------------------------
   –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—Ç–∫–∏:
   ‚Ä¢ –í—ë—Ä—Å—Ç–∫–∞ mobile‚Äëfirst; desktop –ø–æ–ª—É—á–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.
   ‚Ä¢ CSS‚Äë–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ Telegram themeParams, –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã.
   ‚Ä¢ MainButton –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (Buy / Close). –ï—Å—Ç—å —Ñ–∏–∫—Å‚Äë—Ñ—É—Ç–µ—Ä.
   ‚Ä¢ –í—Å–µ —Å—Ü–µ–Ω—ã canvas –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –≤—ã–∫–ª—é—á–∞—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤–∫–ª–∞–¥–æ–∫.
   ‚Ä¢ –ù–∏–∫–∞–∫–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, —Ç–æ–ª—å–∫–æ Telegram WebApp SDK.
   ===================================================================== */

:root{
  --bg:#05060a;            /* –±–∞–∑–æ–≤—ã–π —Ñ–æ–Ω */
  --card:#0c0f15;          /* —Ñ–æ–Ω –∫–∞—Ä—Ç–æ—á–µ–∫ */
  --elev:#0d1117;          /* —Ñ–æ–Ω –ø—Ä–∏–ø–æ–¥–Ω—è—Ç—ã—Ö –±–ª–æ–∫–æ–≤ */
  --stroke:#1e2632;        /* –æ–∫–∞–Ω—Ç–æ–≤–∫–∞/—Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ */
  --text:#E8ECF3;          /* –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∫—Å—Ç */
  --muted:#A8AAB6;         /* –≤—Ç–æ—Ä–∏—á–Ω—ã–π —Ç–µ–∫—Å—Ç */
  --accent:#7C5CFF;        /* —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π */
  --accent2:#00D1FF;       /* —Ü–∏–∞–Ω */
  --ok:#73FFBF;            /* —É—Å–ø–µ—Ö */
  --warn:#FFD166;          /* –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ */
  --danger:#ff6b81;        /* –æ—à–∏–±–∫–∞ */
  --shadow:0 10px 30px rgba(0,0,0,.35);
  --radius:18px;           /* –æ–±—â–∏–π —Ä–∞–¥–∏—É—Å */
  --gap:12px;              /* –±–∞–∑–æ–≤—ã–π –æ—Ç—Å—Ç—É–ø */
  --safe-top: env(safe-area-inset-top);      /* iOS Notch */
  --safe-right: env(safe-area-inset-right);
  --safe-bottom: env(safe-area-inset-bottom);
  --safe-left: env(safe-area-inset-left);
}

/* System reset / mobile tweaks */
*{box-sizing:border-box}
html,body{height:100%;}
html{scroll-behavior:smooth}
body{margin:0;background:var(--bg);color:var(--text);font:15px/1.55 system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
  -webkit-tap-highlight-color: transparent; touch-action: manipulation;}

/* Layout */
.app{min-height:100%;display:grid;grid-template-rows:auto 1fr auto;}
.header{position:sticky;top:0;z-index:20;background:linear-gradient(180deg,rgba(0,0,0,.8),rgba(0,0,0,.45));backdrop-filter:blur(8px);
  border-bottom:1px solid var(--stroke);padding:calc(10px + var(--safe-top)) var(--gap) 10px;}
.header-wrap{max-width:980px;margin:0 auto;display:flex;align-items:center;gap:10px;}
.logo{width:34px;height:34px;border-radius:10px;background:conic-gradient(from 0deg,var(--accent),var(--accent2),var(--accent));box-shadow:0 0 0 2px rgba(255,255,255,.06) inset}
.title{display:flex;flex-direction:column}
.title h1{margin:0;font-size:16px}
.title .sub{margin:2px 0 0;color:var(--muted);font-size:12px}

.lang{margin-left:auto;display:flex;gap:6px}
.lang .chip{font-size:12px;border:1px solid var(--stroke);padding:6px 10px;border-radius:999px;background:#0f1015aa;cursor:pointer}
.lang .chip.active{outline:2px solid rgba(124,92,255,.45)}

/* Tabs (bottom nav on mobile) */
.tabs{position:sticky;bottom:0;left:0;right:0;z-index:20;background:rgba(0,0,0,.92);backdrop-filter:blur(8px);border-top:1px solid var(--stroke);
  padding:8px calc(var(--gap) + var(--safe-left)) calc(8px + var(--safe-bottom)) calc(var(--gap) + var(--safe-right));}
.tabbar{max-width:980px;margin:0 auto;display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
.tabbtn{border:1px solid var(--stroke);background:#12151b;color:var(--text);border-radius:12px;padding:8px 4px;text-align:center;cursor:pointer;
  font-weight:700;font-size:12px;display:flex;flex-direction:column;align-items:center;gap:6px}
.tabbtn svg{width:20px;height:20px;opacity:.92}
.tabbtn.active{outline:2px solid rgba(124,92,255,.45)}

/* Content */
.page{display:none}
.page.active{display:block}
.container{max-width:980px;margin:0 auto;padding:14px var(--gap) calc(90px + var(--safe-bottom))}
.card{background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border:1px solid var(--stroke);border-radius:var(--radius);padding:14px;box-shadow:var(--shadow)}
.block{border:1px solid var(--stroke);border-radius:16px;background:var(--elev);padding:12px}
.grid{display:grid;gap:12px}
.list{display:grid;gap:10px}
.row{display:grid;grid-template-columns:auto 1fr;gap:10px;align-items:start}
.dot{width:8px;height:8px;border-radius:50%;background:var(--accent2);margin-top:8px;box-shadow:0 0 10px var(--accent2)}
.kv{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px}
.kv .item{border:1px solid var(--stroke);border-radius:12px;background:#12141a;padding:10px}
.badges{display:flex;gap:8px;flex-wrap:wrap}
.badge{font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid var(--stroke);background:#0f1015aa}
.badge.warn{border-color:rgba(255,209,102,.4);background:rgba(255,209,102,.08)}

/* Shop */
.shop-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
@media (min-width:520px){.shop-grid{grid-template-columns:repeat(3,1fr)}}
.pack{position:relative;border:1px solid var(--stroke);border-radius:16px;background:linear-gradient(180deg,#0f1220,#0b0f18);padding:12px;display:flex;flex-direction:column;gap:10px}
.pack h4{margin:0;font-size:15px}
.pack .stars{font-weight:900;font-size:24px}
.pack .price{color:var(--muted);font-size:12px}
.pack .buy{margin-top:auto;border:1px solid var(--stroke);background:#181c27;color:var(--text);border-radius:12px;padding:10px;font-weight:800;cursor:pointer;text-align:center}
.pack .buy.primary{outline:2px solid rgba(124,92,255,.45)}
.hint{font-size:12px;color:var(--accent2)}

/* Profile */
.profile{display:grid;gap:10px}
.profile .line{display:flex;justify-content:space-between;border:1px solid var(--stroke);background:#0f1015;padding:10px;border-radius:12px}

/* Canvas scenes */
.canvas-wrap{position:relative;border:1px solid #0d1420;border-radius:16px;overflow:hidden;background:#000}
canvas{display:block;width:100%;height:360px}
.scene-hint{position:absolute;right:10px;top:10px;font-size:12px;color:#6cf;background:rgba(8,20,40,.6);padding:6px 10px;border-radius:999px;border:1px solid #153055}

/* FAQ */
.qa{display:grid;gap:10px}
.qa .q{border:1px solid var(--stroke);background:#11151e;border-radius:12px;padding:10px}
.qa .q summary{cursor:pointer;font-weight:800}
.qa .q summary::-webkit-details-marker{display:none}
.qa .q pre{white-space:pre-wrap;color:var(--muted);margin:8px 0 0}

/* Toasts */
.toast{position:fixed;left:50%;transform:translateX(-50%);bottom:calc(76px + var(--safe-bottom));z-index:50;display:none}
.toast .bubble{background:rgba(20,24,33,.95);border:1px solid var(--stroke);color:var(--text);padding:10px 12px;border-radius:12px;box-shadow:var(--shadow);font-weight:700}
.toast.show{display:block;animation:toast .2s ease-out}
@keyframes toast{from{opacity:0;transform:translate(-50%,10px)}to{opacity:1;transform:translate(-50%,0)}}

/* Skeletons */
.skel{position:relative;overflow:hidden;background:#12151a}
.skel::after{content:"";position:absolute;inset:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,.06),transparent);animation:shine 1.2s infinite}
@keyframes shine{from{transform:translateX(-100%)}to{transform:translateX(100%)}}

/* Accessibility: reduced motion */
@media (prefers-reduced-motion:reduce){
  .toast{animation:none}
}
</style>
</head>
<body>
<div class="app" id="app">
  <!-- ======================== HEADER ======================== -->
  <header class="header">
    <div class="header-wrap">
      <div class="logo" aria-hidden="true"></div>
      <div class="title">
        <h1 id="appTitle">Qleweta ‚Äî –ú–∏–Ω–∏‚Äë–∞–ø–ø</h1>
        <p class="sub" id="subtitle">–í–µ—Ä—Å–∏—è 1.0 ¬∑ –æ–±–Ω–æ–≤–ª–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è</p>
      </div>
      <div class="lang" role="tablist" aria-label="Language switcher">
        <div class="chip active" data-lang="ru" role="tab" aria-selected="true">RU</div>
        <div class="chip" data-lang="en" role="tab" aria-selected="false">EN</div>
      </div>
    </div>
  </header>

  <!-- ======================== PAGES ======================== -->
  <main id="pages">
    <!-- ===== PAGE: STATUS ===== -->
    <section class="page active" id="page-status" aria-labelledby="tab-status">
      <div class="container">
        <div class="card">
          <div class="badges" style="justify-content:space-between;align-items:center;margin-bottom:8px">
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <span class="badge warn" id="badgeBeta">Beta</span>
              <span class="badge" id="badgeVer">–í–µ—Ä—Å–∏—è: 1.0</span>
              <span class="badge" id="badgeUpd">–û–±–Ω–æ–≤–ª–µ–Ω–æ: —Å–µ–≥–æ–¥–Ω—è</span>
            </div>
            <div class="badge" id="badgeClient">Client: ‚Äî</div>
          </div>

          <div class="grid">
            <div class="block">
              <h3 id="st-works">–ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç</h3>
              <div class="list" id="worksList">
                <div class="row"><div class="dot"></div><div>–ê–¥–∞–ø—Ç–∏–≤ –ø–æ–¥ –º–æ–±–∏–ª—ã: safe‚Äëarea, –∫—Ä—É–ø–Ω—ã–µ —Ö–∏—Ç—ã, bottom‚Äënav.</div></div>
                <div class="row"><div class="dot"></div><div>–ì–ª—É–±–æ–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram API: MainButton/BackButton, Haptics, Theme.</div></div>
                <div class="row"><div class="dot"></div><div>–ú–∞–≥–∞–∑–∏–Ω –ø–∞–∫–µ—Ç–æ–≤ Stars ‚Üí <code>sendData("buy_XX")</code> ‚Üí –∏–Ω–≤–æ–π—Å –≤ —á–∞—Ç–µ.</div></div>
                <div class="row"><div class="dot"></div><div>–ü—Ä–æ—Ñ–∏–ª—å –Ω–∞ –±–∞–∑–µ initDataUnsafe (–∏–º—è/—é–∑–µ—Ä–Ω–µ–π–º).</div></div>
                <div class="row"><div class="dot"></div><div>–¢–æ—Å—Ç—ã, –æ—Ñ—Ñ–ª–∞–π–Ω‚Äë–¥–µ—Ç–µ–∫—Ç, skeleton‚Äë–ª–æ–∞–¥–µ—Ä—ã, –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è RU/EN.</div></div>
                <div class="row"><div class="dot"></div><div>–°—Ü–µ–Ω—ã canvas –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã: —Å—Ç–æ–ø/—Å—Ç–∞—Ä—Ç –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤–∫–ª–∞–¥–æ–∫.</div></div>
              </div>
            </div>

            <div class="block">
              <h3>–î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞</h3>
              <div class="kv">
                <div class="item"><b>–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫</b><br><span class="muted">–≤—ã–≥—Ä—É–∑–∫–∞ –∏–∑ –±–æ—Ç–∞</span></div>
                <div class="item"><b>–ü—Ä–æ–º–æ–∫–æ–¥—ã</b><br><span class="muted">–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∏–∑ –º–∏–Ω–∏‚Äë–∞–ø–ø–∞</span></div>
                <div class="item"><b>–¢–µ–º–∏–∑–∞—Ü–∏—è</b><br><span class="muted">—Ä—É—á–Ω–æ–π –≤—ã–±–æ—Ä —Ç–µ–º</span></div>
                <div class="item"><b>–†–µ—Ñ–µ—Ä–∞–ª—ã</b><br><span class="muted">–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–æ–∫</span></div>
              </div>
            </div>

            <div class="block">
              <h3>–ß–µ–π–Ω–¥–∂–ª–æ–≥ 1.0</h3>
              <div class="list">
                <div class="row"><div class="dot"></div><div>–ü–æ–ª–Ω–∞—è –º–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è + bottom‚Äënav –Ω–∞ 5 –≤–∫–ª–∞–¥–æ–∫.</div></div>
                <div class="row"><div class="dot"></div><div>Theme sync —Å Telegram: –∞–≤—Ç–æ‚Äë—Ü–≤–µ—Ç–∞ —Å–≤–µ—Ç–ª–∞—è/—Ç—ë–º–Ω–∞—è.</div></div>
                <div class="row"><div class="dot"></div><div>–ù–æ–≤—ã–π –º–∞–≥–∞–∑–∏–Ω: –∫–∞—Ä—Ç–æ—á–∫–∏ 5/20/100‚≠ê —Å Haptic Feedback.</div></div>
                <div class="row"><div class="dot"></div><div>MainButton –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (Buy / Close).</div></div>
                <div class="row"><div class="dot"></div><div>–¢–æ—Å—Ç—ã, –æ—Ñ—Ñ–ª–∞–π–Ω‚Äë—Ä–µ–∂–∏–º, –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è RU/EN, to‚Äëtop –ø–ª–∞–≤–Ω–æ.</div></div>
              </div>
            </div>

            <div class="block">
              <h3>–î–∏—Å–∫–ª–µ–π–º–µ—Ä</h3>
              <div class="list">
                <div class="row"><div class="dot"></div><div>–û–ø–ª–∞—Ç—ã Stars –Ω–µ–æ–±—Ä–∞—Ç–∏–º—ã –ø–æ –ø—Ä–∞–≤–∏–ª–∞–º Telegram. –î–µ–π—Å—Ç–≤—É–π—Ç–µ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ.</div></div>
                <div class="row"><div class="dot"></div><div>–ú—ã –Ω–µ –æ—Ç–≤–µ—á–∞–µ–º –∑–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã. –ü–æ–ª—å–∑—É—è—Å—å –∞–ø–ø–æ–º, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å —É—Å–ª–æ–≤–∏—è–º–∏.</div></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== PAGE: SHOP ===== -->
    <section class="page" id="page-shop" aria-labelledby="tab-shop">
      <div class="container">
        <div class="card">
          <div class="grid">
            <div class="block">
              <h3 id="shopTitle">–ú–∞–≥–∞–∑–∏–Ω Stars</h3>
              <p class="muted" id="shopSub">–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–∫–µ—Ç ‚Äî –∏–Ω–≤–æ–π—Å –ø—Ä–∏–¥—ë—Ç –≤ —á–∞—Ç. –ó–≤—ë–∑–¥—ã XTR.</p>
              <div class="shop-grid" id="shopGrid">
                <!-- –ü–∞–∫–µ—Ç—ã; –∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–µ—à–∏–≤–∞—é—Ç—Å—è –∏–∑ JS, —á—Ç–æ–±—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–ª–∞ –æ–¥–∏–Ω–∞–∫–æ–≤–æ -->
                <div class="pack" data-amt="5">
                  <h4>–ü–∞–∫–µ—Ç</h4>
                  <div class="stars">5‚≠ê</div>
                  <div class="price">–º–∏–∫—Ä–æ‚Äë–ø–æ–¥–¥–µ—Ä–∂–∫–∞</div>
                  <button class="buy">–ö—É–ø–∏—Ç—å 5‚≠ê</button>
                </div>
                <div class="pack" data-amt="20">
                  <h4>–ü–∞–∫–µ—Ç</h4>
                  <div class="stars">20‚≠ê</div>
                  <div class="price">–ª—É—á—à–∏–π –≤—ã–±–æ—Ä</div>
                  <button class="buy primary">–ö—É–ø–∏—Ç—å 20‚≠ê</button>
                </div>
                <div class="pack" data-amt="100">
                  <h4>–ü–∞–∫–µ—Ç</h4>
                  <div class="stars">100‚≠ê</div>
                  <div class="price">—Å–µ—Ä–¥–µ—á–Ω–æ ‚ù§Ô∏è</div>
                  <button class="buy">–ö—É–ø–∏—Ç—å 100‚≠ê</button>
                </div>
              </div>
              <p class="hint" id="shopHint">–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –º—ã –≤–µ—Ä–Ω—ë–º—Å—è –≤ —á–∞—Ç. –ï—Å–ª–∏ —Å—á—ë—Ç –Ω–µ –ø—Ä–∏—à—ë–ª ‚Äî –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ.</p>
            </div>

            <div class="block">
              <h3>–û—Ç–≤–µ—Ç—ã –Ω–∞ —á–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h3>
              <details class="q"><summary>–ß—Ç–æ —Ç–∞–∫–æ–µ Stars (XTR)?</summary><pre>–≠—Ç–æ –≤–∞–ª—é—Ç–∞ Telegram. –ü–æ–∫—É–ø–∞–µ—Ç–µ –≤ –±–æ—Ç–µ ‚Äî –∑–≤—ë–∑–¥—ã —É—Ö–æ–¥—è—Ç –Ω–∞ –±–∞–ª–∞–Ω—Å –±–æ—Ç–∞.</pre></details>
              <details class="q"><summary>–ì–¥–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–∫—É–ø–∫–∏?</summary><pre>–í —á–∞—Ç–µ –±–æ—Ç–∞: –ø—Ä–æ—Ñ–∏–ª—å ¬´‚ÑπÔ∏è –ò–Ω—Ñ–æ¬ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—É–º–º—É –∏ —É—Ä–æ–≤–µ–Ω—å.</pre></details>
              <details class="q"><summary>–ü–ª–∞—Ç—ë–∂ –Ω–µ –ø—Ä–∏—à—ë–ª?</summary><pre>–û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç —Å –±–æ—Ç–æ–º ‚Äî –∏–Ω–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–æ–∑–≤—Ä–∞—Ç –∏–∑ –º–∏–Ω–∏‚Äë–∞–ø–ø–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.</pre></details>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== PAGE: PROFILE ===== -->
    <section class="page" id="page-profile" aria-labelledby="tab-profile">
      <div class="container">
        <div class="card">
          <div class="grid profile" id="profileGrid">
            <div class="line"><span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span><span id="p_name" class="muted">‚Äî</span></div>
            <div class="line"><span>–Æ–∑–µ—Ä–Ω–µ–π–º</span><span id="p_username" class="muted">‚Äî</span></div>
            <div class="line"><span>ID</span><span id="p_id" class="muted">‚Äî</span></div>
            <div class="line"><span>–ö–ª–∏–µ–Ω—Ç</span><span id="p_client" class="muted">‚Äî</span></div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== PAGE: SANDBOX ===== -->
    <section class="page" id="page-sandbox" aria-labelledby="tab-sandbox">
      <div class="container">
        <div class="card">
          <div class="grid">
            <div class="block">
              <h3>–ü–µ—Å–æ—á–Ω–∏—Ü–∞</h3>
              <div style="display:flex;gap:8px;flex-wrap:wrap;margin:8px 0 10px">
                <button class="chip" data-scene="gpt">ü§ñ ChatGPT Scene</button>
                <button class="chip" data-scene="eyes">üëÄ Eyes</button>
                <button class="chip" data-scene="parts">‚ú® Particles</button>
              </div>

              <!-- GPT Scene -->
              <div class="canvas-wrap scene" id="scene-gpt">
                <canvas id="chat"></canvas>
                <div class="scene-hint">—Ç–∞–ø–Ω–∏/–∫–ª–∏–∫–Ω–∏ –ø–æ —ç–∫—Ä–∞–Ω—É</div>
                <div class="chatlayer" id="chatLayer" style="position:absolute;inset:0;display:grid;place-items:center;text-align:center;color:#00ffd0;text-shadow:0 0 8px #00ffaa;white-space:pre-line;font-family:ui-monospace,monospace">
                  <div>
                    <div id="l1" style="font-size:18px"></div>
                    <div id="l2" style="font-size:18px"></div>
                  </div>
                </div>
                <div class="crt" style="position:absolute;inset:0;pointer-events:none;mix-blend-mode:screen;background:repeating-linear-gradient(0deg,rgba(255,255,255,.04),rgba(255,255,255,.04) 1px,transparent 2px,transparent 3px);opacity:.06"></div>
              </div>

              <!-- Eyes Scene -->
              <div class="canvas-wrap scene" id="scene-eyes" style="display:none">
                <canvas id="eyes"></canvas>
                <div class="scene-hint">—Ç–∞–ø–Ω–∏ –ø–æ –≥–ª–∞–∑—É ‚Äî —Å–ª—É—á–∞–π–Ω—ã–π —Ü–≤–µ—Ç</div>
              </div>

              <!-- Parts Scene -->
              <div class="canvas-wrap scene" id="scene-parts" style="display:none">
                <canvas id="parts"></canvas>
                <div class="scene-hint">—Ç–∞–ø ‚Äî —Å–ø–∞–≤–Ω —á–∞—Å—Ç–∏—Ü ‚Ä¢ –∫—É—Ä—Å–æ—Ä –ø—Ä–∏—Ç—è–≥–∏–≤–∞–µ—Ç</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ===== PAGE: FAQ ===== -->
    <section class="page" id="page-faq" aria-labelledby="tab-faq">
      <div class="container">
        <div class="card">
          <div class="grid">
            <div class="block">
              <h3>FAQ</h3>
              <div class="qa" id="faqList">
                <details class="q"><summary>–ö–∞–∫ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –±–æ—Ç–∞?</summary><pre>–ù–∞–∂–º–∏—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—É—é —Å—Ç—Ä–µ–ª–∫—É –Ω–∞–∑–∞–¥ –≤ Telegram –∏–ª–∏ –∫–Ω–æ–ø–∫—É ¬´–ó–∞–∫—Ä—ã—Ç—å¬ª –≤–Ω–∏–∑—É.
–ï—Å–ª–∏ MainButton –∞–∫—Ç–∏–≤–µ–Ω ‚Äî –æ–Ω —Ç–æ–∂–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç WebApp.</pre></details>
                <details class="q"><summary>–ü–æ—á–µ–º—É –∫–Ω–æ–ø–∫–∞ –Ω–µ –ø—Ä–∏—Å–ª–∞–ª–∞ —Å—á—ë—Ç?</summary><pre>–ò–Ω–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –∑–∞–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–æ–∑–≤—Ä–∞—Ç. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á–∞—Ç –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑. –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ ‚Äî –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–ª–æ–≥ —Å –±–æ—Ç–æ–º.</pre></details>
                <details class="q"><summary>–ö–∞–∫ —Å–º–µ–Ω–∏—Ç—å —è–∑—ã–∫?</summary><pre>–í –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å RU/EN. –ö–æ–Ω—Ç–µ–Ω—Ç –æ–±–Ω–æ–≤–∏—Ç—Å—è —Å—Ä–∞–∑—É.</pre></details>
                <details class="q"><summary>–ì–¥–µ –º–æ—è –∞–≤–∞—Ç–∞—Ä–∫–∞ –∏ –±–∞–ª–∞–Ω—Å?</summary><pre>–ü–æ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ –∏ CORS –∞–≤–∞—Ç–∞—Ä–∫—É –Ω–∞–ø—Ä—è–º—É—é –Ω–µ —Ç—è–Ω–µ–º. –ë–∞–ª–∞–Ω—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –±–æ—Ç–∞.</pre></details>
              </div>
            </div>
            <div class="block">
              <h3>–û—Ç–ª–∞–¥–∫–∞</h3>
              <div class="list">
                <div class="row"><div class="dot"></div><div>–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞: <code id="dbgClient">‚Äî</code></div></div>
                <div class="row"><div class="dot"></div><div>ThemeParams: <code id="dbgTheme">‚Äî</code></div></div>
                <div class="row"><div class="dot"></div><div>isExpanded: <code id="dbgExp">‚Äî</code></div></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- ======================== BOTTOM NAV ======================== -->
  <nav class="tabs" aria-label="–û—Å–Ω–æ–≤–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è">
    <div class="tabbar">
      <button class="tabbtn active" id="tab-status" data-page="page-status" aria-controls="page-status" aria-selected="true" title="–°—Ç–∞—Ç—É—Å">
        <svg viewBox="0 0 24 24" fill="none"><path d="M4 12h16" stroke="currentColor" stroke-width="2"/><path d="M4 6h10" stroke="currentColor" stroke-width="2"/><path d="M4 18h12" stroke="currentColor" stroke-width="2"/></svg>
        <span>–°—Ç–∞—Ç—É—Å</span>
      </button>
      <button class="tabbtn" id="tab-shop" data-page="page-shop" aria-controls="page-shop" title="–ú–∞–≥–∞–∑–∏–Ω">
        <svg viewBox="0 0 24 24" fill="none"><path d="M3 7h18l-1 12H4L3 7Z" stroke="currentColor" stroke-width="2"/><path d="M7 7V5a5 5 0 0 1 10 0v2" stroke="currentColor" stroke-width="2"/></svg>
        <span>–ú–∞–≥–∞–∑–∏–Ω</span>
      </button>
      <button class="tabbtn" id="tab-profile" data-page="page-profile" aria-controls="page-profile" title="–ü—Ä–æ—Ñ–∏–ª—å">
        <svg viewBox="0 0 24 24" fill="none"><circle cx="12" cy="8" r="4" stroke="currentColor" stroke-width="2"/><path d="M4 20c2-4 6-6 8-6s6 2 8 6" stroke="currentColor" stroke-width="2"/></svg>
        <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
      </button>
      <button class="tabbtn" id="tab-sandbox" data-page="page-sandbox" aria-controls="page-sandbox" title="–ü–µ—Å–æ—á–Ω–∏—Ü–∞">
        <svg viewBox="0 0 24 24" fill="none"><path d="M12 2v20M2 12h20" stroke="currentColor" stroke-width="2"/></svg>
        <span>–ü–µ—Å–æ—á–Ω–∏—Ü–∞</span>
      </button>
      <button class="tabbtn" id="tab-faq" data-page="page-faq" aria-controls="page-faq" title="FAQ">
        <svg viewBox="0 0 24 24" fill="none"><path d="M12 18h.01" stroke="currentColor" stroke-width="2"/><path d="M9 8a3 3 0 1 1 6 0c0 2-3 2-3 4" stroke="currentColor" stroke-width="2"/></svg>
        <span>FAQ</span>
      </button>
    </div>
  </nav>
</div>

<!-- ======================== TOAST ======================== -->
<div class="toast" id="toast" role="status" aria-live="polite"><div class="bubble" id="toastText">‚Äî</div></div>

<script>
// ====================================================================
// QLEWETA MINI‚ÄëAPP ‚Äî MOBILE PRO JS
// --------------------------------------------------------------------
// –ó–¥–µ—Å—å –º–Ω–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–æ–≤ –∏ –º–µ–ª–∫–∏—Ö —Ö–µ–ª–ø–µ—Ä–æ–≤ ‚Äî —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ –ª–∞–∫–æ–Ω–∏—á–Ω–æ—Å—Ç–∏.
// ====================================================================
(function(){
  'use strict';

  // ----------------------- Global state -----------------------
  const S = {
    version: '1.0',
    lang: 'ru',
    tg: (window.Telegram && Telegram.WebApp) ? Telegram.WebApp : null,
    scenes: { gpt: null, eyes: null, parts: null },
    currentPage: 'page-status',
    haptics: true,
    offline: !navigator.onLine,
  };

  // ----------------------- i18n -----------------------
  const T = {
    ru: {
      title: 'Qleweta ‚Äî –ú–∏–Ω–∏‚Äë–∞–ø–ø',
      updated: '–æ–±–Ω–æ–≤–ª–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è',
      status: '–°—Ç–∞—Ç—É—Å', shop: '–ú–∞–≥–∞–∑–∏–Ω', profile: '–ü—Ä–æ—Ñ–∏–ª—å', sandbox: '–ü–µ—Å–æ—á–Ω–∏—Ü–∞', faq: 'FAQ',
      shopTitle: '–ú–∞–≥–∞–∑–∏–Ω Stars', shopSub: '–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞–∫–µ—Ç ‚Äî –∏–Ω–≤–æ–π—Å –ø—Ä–∏–¥—ë—Ç –≤ —á–∞—Ç. –ó–≤—ë–∑–¥—ã XTR.',
      shopHint: '–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –º—ã –≤–µ—Ä–Ω—ë–º—Å—è –≤ —á–∞—Ç. –ï—Å–ª–∏ —Å—á—ë—Ç –Ω–µ –ø—Ä–∏—à—ë–ª ‚Äî –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ.',
      buy: amt => `–ö—É–ø–∏—Ç—å ${amt}‚≠ê`,
      toastBuy: amt => `–ó–∞–ø—Ä–æ—Å –Ω–∞ ${amt}‚≠ê –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω`,
      profile: { user:'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å', username:'–Æ–∑–µ—Ä–Ω–µ–π–º', id:'ID', client:'–ö–ª–∏–µ–Ω—Ç' },
      close: '–ó–∞–∫—Ä—ã—Ç—å',
    },
    en: {
      title: 'Qleweta ‚Äî Mini App',
      updated: 'updated today',
      status: 'Status', shop: 'Shop', profile: 'Profile', sandbox: 'Sandbox', faq: 'FAQ',
      shopTitle: 'Stars Shop', shopSub: 'Choose a pack ‚Äî invoice will appear in chat. XTR stars.',
      shopHint: 'After press we return to chat. If invoice is missing ‚Äî try again.',
      buy: amt => `Buy ${amt}‚≠ê`,
      toastBuy: amt => `Request for ${amt}‚≠ê sent`,
      profile: { user:'User', username:'Username', id:'ID', client:'Client' },
      close: 'Close',
    }
  };

  // ----------------------- Helpers -----------------------
  const $ = sel => document.querySelector(sel);
  const $$ = sel => Array.from(document.querySelectorAll(sel));
  const on = (el, ev, fn, opt) => el && el.addEventListener(ev, fn, opt);

  function toast(msg){
    const box=$('#toast'); const txt=$('#toastText');
    if(!box||!txt) return; txt.textContent=msg; box.classList.add('show');
    if(S.haptics) try{ S.tg?.HapticFeedback?.notificationOccurred('success'); }catch(e){}
    clearTimeout(toast._t); toast._t=setTimeout(()=> box.classList.remove('show'), 1800);
  }

  function setActivePage(id){
    if(S.currentPage===id) return;
    $$('.page').forEach(p=>p.classList.toggle('active', p.id===id));
    $$('.tabbtn').forEach(b=>b.classList.toggle('active', b.dataset.page===id));
    S.currentPage = id;
    updateMainButton();
    // –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Å—Ü–µ–Ω—ã
    stopScenesExcept(id);
    // –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–∞—á–∞–ª—É
    try{ window.scrollTo({top:0,behavior:'smooth'}); }catch(e){}
  }

  function stopScenesExcept(id){
    const stop = name => { if(S.scenes[name] && typeof S.scenes[name].stop==='function') S.scenes[name].stop(); };
    if(id!=='page-sandbox'){ stop('gpt'); stop('eyes'); stop('parts'); }
  }

  function updateTexts(){
    const t=T[S.lang];
    $('#appTitle').textContent=t.title; $('#subtitle').textContent=`–í–µ—Ä—Å–∏—è 1.0 ¬∑ ${t.updated}`;
    $('#tab-status span').textContent=t.status;
    $('#tab-shop span').textContent=t.shop;
    $('#tab-profile span').textContent=t.profile;
    $('#tab-sandbox span').textContent=t.sandbox;
    $('#tab-faq span').textContent=t.faq;
    $('#shopTitle').textContent=t.shopTitle; $('#shopSub').textContent=t.shopSub; $('#shopHint').textContent=t.shopHint;
    // –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–¥–ø–∏—Å–∏ –æ—Å—Ç–∞—é—Ç—Å—è –≤ —Å—Ç–∞—Ç–∏–∫ —Ä–∞–∑–º–µ—Ç–∫–µ, –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ —Ç—Ä–æ–≥–∞–µ–º
    // –ö–Ω–æ–ø–∫–∏ –ø–æ–∫—É–ø–∫–∏ –æ–±–Ω–æ–≤–∏–º
    $$('#page-shop .pack').forEach(p=>{
      const amt=+p.dataset.amt; p.querySelector('.buy').textContent=t.buy(amt);
    });
    updateMainButton();
  }

  function updateMainButton(){
    if(!S.tg) return;
    const t=T[S.lang];
    if(S.currentPage==='page-shop'){
      S.tg.MainButton.setParams({text:t.close});
      S.tg.MainButton.show();
      S.tg.MainButton.onClick(closeApp);
    }else{
      S.tg.MainButton.setParams({text:t.close});
      S.tg.MainButton.show();
      S.tg.MainButton.onClick(closeApp);
    }
  }

  function closeApp(){ try{ S.tg?.close(); }catch(e){} }

  function haptic(type='light'){ if(!S.haptics) return; try{ S.tg?.HapticFeedback?.impactOccurred(type); }catch(e){} }

  // ----------------------- Theme sync -----------------------
  function applyThemeFromTelegram(){
    if(!S.tg) return;
    const th = S.tg.themeParams||{};
    // –¥–µ–ª–∏–∫–∞—Ç–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ–º –æ—Ç—Ç–µ–Ω–∫–∏, –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω—ã
    const map={
      text_color:'--text', hint_color:'--muted', bg_color:'--bg', secondary_bg_color:'--card',
      link_color:'--accent2', button_color:'--accent', button_text_color:'--text'
    };
    for(const k in map){ if(th[k]) document.documentElement.style.setProperty(map[k], th[k]); }
  }

  // ----------------------- Offline detector -----------------------
  function updateOffline(){
    if(!navigator.onLine){ S.offline=true; toast('‚ö†Ô∏è –ù–µ—Ç —Å–µ—Ç–∏'); }
    else if(S.offline){ S.offline=false; toast('‚úÖ –°–µ—Ç—å –µ—Å—Ç—å'); }
  }

  // ----------------------- Profile from initData -----------------------
  function fillProfile(){
    const unsafe = S.tg?.initDataUnsafe||{}; const user=unsafe.user||{};
    $('#p_name').textContent = [user.first_name,user.last_name].filter(Boolean).join(' ')||'‚Äî';
    $('#p_username').textContent = user.username?('@'+user.username):'‚Äî';
    $('#p_id').textContent = user.id||'‚Äî';
    const client = `${S.tg?.platform||'web'}`; $('#p_client').textContent = client;
    $('#badgeClient').textContent = 'Client: '+client;
    $('#dbgClient').textContent = client;
    $('#dbgExp').textContent = S.tg?.isExpanded?'true':'false';
    $('#dbgTheme').textContent = JSON.stringify(S.tg?.themeParams||{},null,0);
  }

  // ----------------------- Shop actions -----------------------
  function buyStars(amount){
    haptic('rigid');
    const t=T[S.lang];
    try{
      S.tg?.sendData?.('buy_'+amount);
      toast(t.toastBuy(amount));
      // –Ω–µ–±–æ–ª—å—à–æ–π —Ç–∞–π–º–µ—Ä ‚Äî –∑–∞–∫—Ä—ã–≤–∞–µ–º –∞–ø–ø, —á—Ç–æ–±—ã –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ —á–∞—Ç
      setTimeout(()=> closeApp(), 220);
    }catch(e){ toast('–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å'); }
  }

  // ----------------------- Scenes (canvas) -----------------------
  // GPT Scene
  function SceneGPT(){
    let canvas,ctx,raf=0,started=false,clickBound=false,t=0;
    return {
      start(){ if(started) return; started=true; canvas=$('#chat'); ctx=canvas.getContext('2d');
        const resize=()=>{ const box=canvas.parentElement,W=box.clientWidth,H=360; const dpr=window.devicePixelRatio||1; canvas.width=W*dpr;canvas.height=H*dpr;canvas.style.width=W+'px';canvas.style.height=H+'px'; ctx.setTransform(dpr,0,0,dpr,0,0);};
        this._resize=resize; resize(); window.addEventListener('resize',resize);
        const loop=()=>{ t+=0.015; const W=canvas.width/(window.devicePixelRatio||1), H=canvas.height/(window.devicePixelRatio||1);
          const r=60+Math.sin(t)*25,R=360; const gx=W/2+Math.sin(t*0.7)*40, gy=H/2+Math.cos(t*0.6)*24; const g=ctx.createRadialGradient(gx,gy,r,W/2,H/2,R);
          g.addColorStop(0,'rgba(0,255,210,0.32)'); g.addColorStop(0.45,'rgba(0,140,200,0.15)'); g.addColorStop(1,'rgba(0,0,0,1)'); ctx.fillStyle=g; ctx.fillRect(0,0,W,H);
          raf=requestAnimationFrame(loop);
        }; loop();
        // typewriter text
        const l1=$('#l1'), l2=$('#l2');
        const type=(el,txt,spd=22,done)=>{ el.textContent=''; let i=0; const tick=()=>{ if(i<txt.length){ el.textContent+=txt[i++]; if(i%3===0) haptic('light'); setTimeout(tick,spd);} else done&&done(); }; tick(); };
        type(l1,'üëã –ü—Ä–∏–≤–µ—Ç! –Ø ChatGPT. –ù–∞–∂–º–∏ –Ω–∞ —ç–∫—Ä–∞–Ω ‚Äî –æ—Ç–≤–µ—á—É',18);
        if(!clickBound){ clickBound=true; const trigger=()=>{ l1.textContent='–û—Ç–≤–µ—Ç:'; type(l2,'–ê—Ö–∞—Ö–∞—Ö üòÜ –Ω—É —Ç—ã —á—ë, –ø–æ–≤–µ—Ä–∏–ª?\nAPI –¥–æ—Ä–æ–≥–∏–µ —Å–µ–π—á–∞—Å, –±—Ä–æ üí∏',14); }; on($('#scene-gpt'),'click',trigger,{passive:true}); on($('#scene-gpt'),'touchstart',e=>{e.preventDefault();trigger();},{passive:false}); }
      },
      stop(){ if(!started) return; started=false; cancelAnimationFrame(raf); window.removeEventListener('resize',this._resize); }
    }
  }

  // Eyes Scene
  function SceneEyes(){
    let canvas,ctx,raf=0,started=false,eyes=[],mx=0,my=0,active=false,dpr=1,W=0,H=0;
    return {
      start(){ if(started) return; started=true; canvas=$('#eyes'); ctx=canvas.getContext('2d');
        const resize=()=>{ const box=canvas.parentElement; W=box.clientWidth; H=360; dpr=Math.max(1,Math.min(2,window.devicePixelRatio||1)); canvas.width=W*dpr;canvas.height=H*dpr; canvas.style.width=W+'px';canvas.style.height=H+'px'; ctx.setTransform(dpr,0,0,dpr,0,0); eyes=[{x:W*0.38,y:H*0.5,r:62,iris:'#66ccff'},{x:W*0.62,y:H*0.5,r:62,iris:'#66ccff'}]; mx=W/2; my=H/2; };
        this._resize=resize; resize(); window.addEventListener('resize',resize);
        const setMouse=e=>{ const r=canvas.getBoundingClientRect(); const p=('touches'in e)?e.touches[0]:e; mx=p.clientX-r.left; my=p.clientY-r.top; active=true; };
        const clearMouse=()=>{ active=false; };
        on(canvas,'mousemove',setMouse); on(canvas,'mouseleave',clearMouse); on(canvas,'touchstart',setMouse,{passive:false}); on(canvas,'touchmove',setMouse,{passive:false}); on(window,'touchend',clearMouse);
        on(canvas,'click',e=>{ const r=canvas.getBoundingClientRect(); const x=e.clientX-r.left,y=e.clientY-r.top; for(const eye of eyes){ if(Math.hypot(x-eye.x,y-eye.y)<=eye.r) eye.iris=`hsl(${(Math.random()*360)|0},90%,60%)`; } });
        const drawEye=eye=>{ const {x,y,r,iris}=eye; ctx.shadowBlur=18; ctx.shadowColor='rgba(180,200,255,.35)'; ctx.fillStyle='#0b0f18'; ctx.strokeStyle='#2a2f3a'; ctx.lineWidth=2; ctx.beginPath(); ctx.arc(x,y,r,0,Math.PI*2); ctx.fill(); ctx.stroke(); const dx=mx-x, dy=my-y, dist=Math.hypot(dx,dy); const lim=r*0.45; const px=x+(dist>lim?dx/dist*lim:dx); const py=y+(dist>lim?dy/dist*lim:dy); ctx.shadowBlur=20; ctx.shadowColor=iris; ctx.fillStyle=iris; ctx.beginPath(); ctx.arc(px,py,r*0.36,0,Math.PI*2); ctx.fill(); ctx.shadowBlur=10; ctx.shadowColor='#000'; ctx.fillStyle='#000'; ctx.beginPath(); ctx.arc(px,py,r*0.18,0,Math.PI*2); ctx.fill(); ctx.shadowBlur=0; ctx.fillStyle='rgba(255,255,255,.9)'; ctx.beginPath(); ctx.arc(px-r*0.1,py-r*0.1,r*0.06,0,Math.PI*2); ctx.fill(); };
        const loop=()=>{ ctx.clearRect(0,0,W,H); ctx.fillStyle='#000'; ctx.fillRect(0,0,W,H); eyes[0].x=W*0.38; eyes[0].y=H*0.5; eyes[1].x=W*0.62; eyes[1].y=H*0.5; for(const e of eyes) drawEye(e); raf=requestAnimationFrame(loop); };
        loop();
      },
      stop(){ if(!started) return; started=false; cancelAnimationFrame(raf); window.removeEventListener('resize',this._resize); }
    }
  }

  // Particles Scene
  function SceneParts(){
    let canvas,ctx,raf=0,started=false,P=[],mx=0,my=0,active=false,dpr=1,W=0,H=0,last=0;
    const spawn=(x,y,n=16)=>{ for(let i=0;i<n;i++){ const a=Math.random()*Math.PI*2; const v=40+Math.random()*140; P.push({x,y,vx:Math.cos(a)*v,vy:Math.sin(a)*v,r:2+Math.random()*3,h:(Math.random()*360)|0,life:2}); } };
    return {
      start(){ if(started) return; started=true; canvas=$('#parts'); ctx=canvas.getContext('2d');
        const resize=()=>{ const box=canvas.parentElement; W=box.clientWidth; H=360; dpr=Math.max(1,Math.min(2,window.devicePixelRatio||1)); canvas.width=W*dpr;canvas.height=H*dpr; canvas.style.width=W+'px';canvas.style.height=H+'px'; ctx.setTransform(dpr,0,0,dpr,0,0); };
        this._resize=resize; resize(); window.addEventListener('resize',resize);
        const setMouse=e=>{ const r=canvas.getBoundingClientRect(); const p=('touches'in e)?e.touches[0]:e; mx=p.clientX-r.left; my=p.clientY-r.top; active=true; };
        const clearMouse=()=>{ active=false; };
        on(canvas,'mousemove',setMouse); on(canvas,'mouseleave',clearMouse); on(canvas,'touchstart',setMouse,{passive:false}); on(canvas,'touchmove',setMouse,{passive:false}); on(window,'touchend',clearMouse);
        on(canvas,'click',e=>{ const r=canvas.getBoundingClientRect(); spawn(e.clientX-r.left,e.clientY-r.top,20); haptic('medium'); });
        spawn(W/2,H/2,28); last=performance.now();
        const loop=(now)=>{ const dt=Math.min(40,now-last)/1000; last=now; ctx.fillStyle='rgba(0,0,0,0.25)'; ctx.fillRect(0,0,W,H); for(const p of P){ if(active){ const dx=mx-p.x, dy=my-p.y, d=Math.hypot(dx,dy)+1; const f=120/d; p.vx+=dx/d*f*dt; p.vy+=dy/d*f*dt; } p.vx*=0.99; p.vy*=0.99; p.x+=p.vx*dt; p.y+=p.vy*dt; if(p.x<0||p.x>W) p.vx*=-1; if(p.y<0||p.y>H) p.vy*=-1; p.life-=dt*0.25; ctx.shadowBlur=14; ctx.shadowColor=`hsla(${p.h},100%,60%,.9)`; ctx.fillStyle=`hsla(${p.h},95%,60%,.9)`; ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill(); } for(let i=P.length-1;i>=0;i--) if(P[i].life<=0) P.splice(i,1); raf=requestAnimationFrame(loop); };
        raf=requestAnimationFrame(loop);
      },
      stop(){ if(!started) return; started=false; cancelAnimationFrame(raf); window.removeEventListener('resize',this._resize); }
    }
  }

  // ----------------------- Router binding -----------------------
  function bindTabs(){
    $$('.tabbtn').forEach(btn=> on(btn,'click',()=>{ setActivePage(btn.dataset.page); haptic('light'); }));
  }

  function bindLang(){
    $$('.lang .chip').forEach(ch=> on(ch,'click',()=>{ $$('.lang .chip').forEach(x=>x.classList.remove('active')); ch.classList.add('active'); S.lang=ch.dataset.lang; updateTexts(); haptic('light'); }));
  }

  function bindShop(){
    $$('#page-shop .pack .buy').forEach(b=> on(b,'click',()=> buyStars(+b.closest('.pack').dataset.amt)));
  }

  function bindSandbox(){
    const chips=$$('#page-sandbox .chip');
    const show=id=>{
      $('#scene-gpt').style.display= id==='gpt'?'':'none';
      $('#scene-eyes').style.display= id==='eyes'?'':'none';
      $('#scene-parts').style.display= id==='parts'?'':'none';
      chips.forEach(c=>c.classList.toggle('active', c.dataset.scene===id));
      if(id==='gpt'){ S.scenes.gpt||(S.scenes.gpt=SceneGPT()); S.scenes.gpt.start(); }
      if(id==='eyes'){ S.scenes.eyes||(S.scenes.eyes=SceneEyes()); S.scenes.eyes.start(); }
      if(id==='parts'){ S.scenes.parts||(S.scenes.parts=SceneParts()); S.scenes.parts.start(); }
    };
    chips.forEach(c=> on(c,'click',()=>{ show(c.dataset.scene); haptic('light'); }));
    show('gpt');
  }

  // ----------------------- Init -----------------------
  function init(){
    applyThemeFromTelegram();
    bindTabs(); bindLang(); bindShop(); bindSandbox();
    updateTexts(); fillProfile(); updateOffline();
    on(window,'online',updateOffline); on(window,'offline',updateOffline);
    if(S.tg){ S.tg.ready(); S.tg.expand(); S.tg.BackButton.onClick(closeApp); }
  }

  document.addEventListener('DOMContentLoaded', init);
})();
</script>
</body>
</html>
