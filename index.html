<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Stars Shop ‚Äî Premium</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <meta name="color-scheme" content="dark light">

  <style>
    :root{
      --bg:#0b0c10; --card:#131419; --stroke:#22242B; --text:#F3F4F8; --muted:#A8AAB6;
      --accent:#7C5CFF; --accent2:#00D1FF; --ok:#73FFBF; --bad:#FF8B8B;
      --shadow: 0 20px 60px rgba(0,0,0,.55);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text); font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto;
      background:
        radial-gradient(60% 60% at 80% 10%, rgba(124,92,255,.18), transparent 60%),
        radial-gradient(50% 50% at 10% 90%, rgba(0,200,255,.12), transparent 60%),
        var(--bg);
      overflow-x:hidden;
    }

    /* ‚Äî –Ω–µ–æ–Ω–æ–≤—ã–π —Ñ–æ–Ω ‚Äî */
    .glow-bg{
      position:fixed; inset:-20vmax; pointer-events:none; z-index:-1; filter:blur(60px);
      background:
        radial-gradient(30vmax 30vmax at 20% 20%, rgba(124,92,255,.3), transparent 60%),
        radial-gradient(35vmax 35vmax at 80% 70%, rgba(0,209,255,.25), transparent 60%),
        radial-gradient(25vmax 25vmax at 50% 10%, rgba(255,165,0,.18), transparent 60%);
      animation: floatGlow 20s ease-in-out infinite alternate; opacity:.9;
    }
    @keyframes floatGlow{from{transform:translate3d(-2%,-2%,0) scale(1)}to{transform:translate3d(2%,2%,0) scale(1.03)}}

    .wrap{min-height:100%; display:grid; place-items:center; padding:28px 16px}

    .card{
      width:min(980px,96vw);
      background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));
      border:1px solid var(--stroke); border-radius:22px; padding:22px 18px;
      box-shadow:var(--shadow); backdrop-filter:blur(8px);
      transform:translateY(0); transition:transform .25s;
    }
    .card:hover{ transform:translateY(-2px) }

    .head{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:10px}
    .title{display:flex; align-items:center; gap:10px}
    .logo{
      width:38px; height:38px; border-radius:12px;
      background:conic-gradient(from 0deg, var(--accent), var(--accent2), var(--accent));
      box-shadow:0 0 24px rgba(124,92,255,.45), inset 0 0 22px rgba(255,255,255,.08);
      animation:spinSlow 9s linear infinite;
    }
    @keyframes spinSlow{from{rotate:0}to{rotate:360deg}}
    h1{margin:0; font-size:22px} .sub{color:var(--muted); margin:0; font-size:14px}

    .env{font-size:13px; padding:8px 12px; border:1px solid var(--stroke); border-radius:999px; background:#0f1015aa}

    .grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:14px; margin-top:12px}
    .product{
      position:relative; background:#0f1015; border:1px solid var(--stroke); border-radius:18px;
      padding:16px; box-shadow:0 10px 28px rgba(0,0,0,.35); perspective:800px;
      transition:transform .2s, box-shadow .2s;
    }
    .product:hover{ transform:translateY(-3px); box-shadow:0 18px 40px rgba(0,0,0,.55) }
    .tag{position:absolute; top:10px; right:10px; font-size:11px; padding:4px 8px; border-radius:999px; background:rgba(124,92,255,.18); border:1px solid rgba(124,92,255,.35); color:#D9D3FF}
    .title2{font-weight:800; margin:8px 0 4px; font-size:15px}
    .desc{color:var(--muted); font-size:13px; margin:0 0 14px; min-height:40px}
    .row{display:flex; align-items:center; justify-content:space-between; gap:10px}
    .price{font-weight:900; letter-spacing:.2px}

    .btn{
      border:0; border-radius:13px; padding:12px 14px; cursor:pointer; font-weight:900;
      background:#1C1D22; color:var(--text); box-shadow:0 0 0 rgba(124,92,255,0);
      transition:transform .15s, box-shadow .2s;
    }
    .btn:hover{ transform:translateY(-1px); box-shadow:0 0 36px rgba(124,92,255,.55) }
    .btn:active{ transform:translateY(0) }

    .foot{display:flex; justify-content:space-between; align-items:center; gap:12px; margin-top:14px; color:var(--muted); font-size:13px}
    .status.ok{color:var(--ok)} .status.bad{color:var(--bad)}

    .toast{
      position:fixed; left:50%; bottom:22px; transform:translateX(-50%) translateY(120%);
      background:#12131a; border:1px solid var(--stroke); color:var(--text);
      padding:12px 16px; border-radius:12px; box-shadow:var(--shadow); z-index:5;
      transition:transform .3s, opacity .3s; opacity:0; pointer-events:none;
    }
    .toast.show{ transform:translateX(-50%) translateY(0); opacity:1 }

    @media (max-width:420px){
      .head{flex-direction:column; align-items:flex-start}
      .foot{flex-direction:column; align-items:flex-start}
    }
  </style>
</head>
<body>
  <div class="glow-bg"></div>

  <div class="wrap">
    <div class="card">
      <div class="head">
        <div class="title">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <h1>–ú–∞–≥–∞–∑–∏–Ω ‚≠ê Stars</h1>
            <p class="sub">–í—ã–±–µ—Ä–∏ –ø–∞–∫–µ—Ç ‚Äî –±–æ—Ç –ø—Ä–∏—à–ª—ë—Ç –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã –≤ —á–∞—Ç</p>
          </div>
        </div>
        <div class="env" id="env">–ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è‚Ä¶</div>
      </div>

      <div class="grid">
        <div class="product" data-tilt>
          <span class="tag">–°—Ç–∞—Ä—Ç</span>
          <div class="title2">Premium Mini</div>
          <p class="desc">–†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç –±–∞–∑–æ–≤—ã–µ —Ñ–∏—á–∏.</p>
          <div class="row">
            <div class="price">5‚≠ê</div>
            <button class="btn" onclick="buy('buy_5')">–ö—É–ø–∏—Ç—å</button>
          </div>
        </div>

        <div class="product" data-tilt>
          <span class="tag">–¢–æ–ø –≤—ã–±–æ—Ä</span>
          <div class="title2">Premium Plus</div>
          <p class="desc">–ë–æ–ª—å—à–µ –ø–ª—é—à–µ–∫, –ª—É—á—à–∏–π value.</p>
          <div class="row">
            <div class="price">20‚≠ê</div>
            <button class="btn" onclick="buy('buy_20')">–ö—É–ø–∏—Ç—å</button>
          </div>
        </div>

        <div class="product" data-tilt>
          <span class="tag">–ú–∞–∫—Å</span>
          <div class="title2">Premium Ultra</div>
          <p class="desc">–í—Å—ë –∏ —Å—Ä–∞–∑—É. –ü–æ–¥–¥–µ—Ä–∂–∏ –ø—Ä–æ–µ–∫—Ç üíú</p>
          <div class="row">
            <div class="price">100‚≠ê</div>
            <button class="btn" onclick="buy('buy_100')">–ö—É–ø–∏—Ç—å</button>
          </div>
        </div>
      </div>

      <div class="foot">
        <span>üí° –û–ø–ª–∞—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —á–∞—Ç–µ —Å –±–æ—Ç–æ–º. –ú—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω—ë–º —Ç–µ–±—è —Ç—É–¥–∞ –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞ ¬´–ö—É–ø–∏—Ç—å¬ª.</span>
        <span id="status" class="status"></span>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">–ì–æ—Ç–æ–≤–æ</div>

  <script>
    // (username –Ω–µ –Ω—É–∂–µ–Ω ‚Äî –¥–∏–ø–ª–∏–Ω–∫–∏ –æ—Ç–∫–ª—é—á–∏–ª–∏)
    // const BOT_USERNAME = "QlewetaBot";

    const envEl = document.getElementById('env');
    const statusEl = document.getElementById('status');
    const toastEl = document.getElementById('toast');

    const isWebApp = !!(window.Telegram && Telegram.WebApp);
    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;

    envEl.textContent = isWebApp ? "WebApp OK ‚úÖ" : "Not in Telegram ‚ùå";

    if (isWebApp) {
      Telegram.WebApp.ready();
      Telegram.WebApp.expand();

      // –Ω–∞ –±—É–¥—É—â–µ–µ ‚Äî –µ—Å–ª–∏ –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å –æ—Ç–∫—Ä–æ–µ–º –∏–Ω–≤–æ–π—Å –≤–Ω—É—Ç—Ä–∏ WebApp
      Telegram.WebApp.onEvent('invoiceClosed', (d) => {
        if (!d || !d.status) return;
        if (d.status === 'paid') {
          statusEl.textContent = "‚úÖ –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞";
          statusEl.className = "status ok";
        } else if (d.status === 'cancelled') {
          statusEl.textContent = "‚ùå –û–ø–ª–∞—Ç–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞";
          statusEl.className = "status bad";
        } else {
          statusEl.textContent = "‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å";
          statusEl.className = "status";
        }
      });
    }

    // —Ç–æ—Å—Ç
    function showToast(text){
      toastEl.textContent = text;
      toastEl.classList.add('show');
      setTimeout(()=>toastEl.classList.remove('show'), 1800);
    }

    // 3D-tilt
    document.querySelectorAll('[data-tilt]').forEach(card=>{
      let r = card.getBoundingClientRect();
      function move(e){
        const x = (e.clientX - r.left) / r.width;
        const y = (e.clientY - r.top) / r.height;
        card.style.transform = `translateY(-3px) rotateX(${(0.5-y)*8}deg) rotateY(${(x-0.5)*8}deg)`;
      }
      function leave(){ card.style.transform = 'translateY(0) rotateX(0) rotateY(0)'; }
      card.addEventListener('mousemove', move);
      card.addEventListener('mouseleave', leave);
      window.addEventListener('resize', ()=>{ r = card.getBoundingClientRect(); });
    });

    // ===== –ü–æ–∫—É–ø–∫–∞: sendData -> –∑–∞–∫—Ä—ã—Ç—å –º–∏–Ω–∏-–∞–ø–ø =====
    let busy = false;

    function buy(code){
      if (!isWebApp) { alert("–û—Ç–∫—Ä–æ–π —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –±–æ—Ç–∞ –≤ Telegram."); return; }
      if (busy) return; // –∑–∞—â–∏—Ç–∞ –æ—Ç –¥–≤–æ–π–Ω—ã—Ö –∫–ª–∏–∫–æ–≤
      busy = true;

      showToast("–û—Ç–ø—Ä–∞–≤–ª—è—é –≤ –±–æ—Ç–∞‚Ä¶");
      try { Telegram.WebApp.HapticFeedback.impactOccurred('light'); } catch(e){}

      try {
        Telegram.WebApp.sendData(code); // –±–æ—Ç –ø–æ–ª—É—á–∏—Ç buy_* –∏ –≤—ã—à–ª–µ—Ç 1 –∏–Ω–≤–æ–π—Å
      } catch (e) {
        console.warn("sendData failed", e);
        busy = false;
        showToast("–ß—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫‚Ä¶");
        return;
      }

      // –¥–∞—ë–º –¢–µ–ª–µ–≥–µ –¥–æ—Å—Ç–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ –∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º WebApp ‚Üí —Å—Ä–∞–∑—É –≤ —á–∞—Ç
      setTimeout(()=>{
        try { Telegram.WebApp.close(); } catch(e){}
        setTimeout(()=>{ busy = false; }, 1000);
      }, isIOS ? 120 : 80);
    }
  </script>
</body>
</html>
