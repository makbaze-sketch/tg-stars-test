<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Stars Shop ‚Äî Premium</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <meta name="color-scheme" content="dark light">

  <style>
    :root{
      --bg:#0b0c10; --card:#131419; --stroke:#22242B; --text:#F3F4F8; --muted:#A8AAB6;
      --accent:#7C5CFF; --accent2:#00D1FF; --ok:#73FFBF; --bad:#FF8B8B;
      --shadow: 0 20px 60px rgba(0,0,0,.55);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text); font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto;
      background: radial-gradient(60% 60% at 80% 10%, rgba(124,92,255,.18), transparent 60%),
                  radial-gradient(50% 50% at 10% 90%, rgba(0,200,255,.12), transparent 60%),
                  var(--bg);
      overflow-x:hidden;
    }

    /* === –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–µ–æ–Ω-—Ñ–æ–Ω === */
    .glow-bg{
      position:fixed; inset:-20vmax; pointer-events:none; z-index:-1; filter:blur(60px);
      background:
        radial-gradient(30vmax 30vmax at 20% 20%, rgba(124,92,255,.3), transparent 60%),
        radial-gradient(35vmax 35vmax at 80% 70%, rgba(0,209,255,.25), transparent 60%),
        radial-gradient(25vmax 25vmax at 50% 10%, rgba(255,165,0,.18), transparent 60%);
      animation: floatGlow 20s ease-in-out infinite alternate;
      opacity:.9;
    }
    @keyframes floatGlow{
      from{ transform:translate3d(-2%, -2%, 0) scale(1) }
      to  { transform:translate3d( 2%,  2%, 0) scale(1.03) }
    }

    /* === –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä === */
    .wrap{min-height:100%; display:grid; place-items:center; padding:28px 16px}

    /* === –∫–∞—Ä—Ç–æ—á–∫–∞ === */
    .card{
      width:min(980px, 96vw);
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--stroke); border-radius:22px; padding:22px 18px;
      box-shadow:var(--shadow); backdrop-filter:blur(8px);
      transform:translateY(0); transition:transform .25s ease;
    }
    .card:hover{ transform:translateY(-2px) }

    /* === —à–∞–ø–∫–∞ === */
    .head{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:10px}
    .title{display:flex; align-items:center; gap:10px}
    .logo{
      width:38px; height:38px; border-radius:12px;
      background: conic-gradient(from 0deg, var(--accent), var(--accent2), var(--accent));
      box-shadow:0 0 24px rgba(124,92,255,.45), inset 0 0 22px rgba(255,255,255,.08);
      animation: spinSlow 9s linear infinite;
    }
    @keyframes spinSlow{ from{rotate:0} to{rotate:360deg} }
    h1{margin:0; font-size:22px; letter-spacing:.2px}
    .sub{color:var(--muted); margin:0; font-size:14px}

    .env{
      font-size:13px; padding:8px 12px; border:1px solid var(--stroke); border-radius:999px;
      background:#0f1015aa;
    }

    /* === —Å–µ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ === */
    .grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:14px; margin-top:12px}
    .product{
      position:relative; background:#0f1015; border:1px solid var(--stroke); border-radius:18px;
      padding:16px; box-shadow:0 10px 28px rgba(0,0,0,.35);
      transition: transform .2s ease, box-shadow .2s ease;
      perspective:800px;
    }
    .product:hover{ transform:translateY(-3px); box-shadow:0 18px 40px rgba(0,0,0,.55) }
    .tag{
      position:absolute; top:10px; right:10px; font-size:11px; padding:4px 8px; border-radius:999px;
      background:rgba(124,92,255,.18); border:1px solid rgba(124,92,255,.35); color:#D9D3FF
    }
    .title2{font-weight:800; margin:8px 0 4px; font-size:15px}
    .desc{color:var(--muted); font-size:13px; margin:0 0 14px; min-height:40px}
    .row{display:flex; align-items:center; justify-content:space-between; gap:10px}
    .price{font-weight:900; letter-spacing:.2px}

    .btn{
      border:0; border-radius:13px; padding:12px 14px; cursor:pointer; font-weight:900;
      background:#1C1D22; color:var(--text);
      box-shadow:0 0 0 rgba(124,92,255,0);
      transition: transform .15s ease, box-shadow .2s ease;
    }
    .btn:hover{ transform:translateY(-1px); box-shadow:0 0 36px rgba(124,92,255,.55) }
    .btn:active{ transform:translateY(0) }

    /* === —Ñ—É—Ç–µ—Ä === */
    .foot{display:flex; justify-content:space-between; align-items:center; gap:12px; margin-top:14px; color:var(--muted); font-size:13px}
    .status.ok{ color:var(--ok) } .status.bad{ color:var(--bad) }

    /* === —Ç–æ—Å—Ç === */
    .toast{
      position:fixed; left:50%; bottom:22px; transform:translateX(-50%) translateY(120%);
      background:#12131a; border:1px solid var(--stroke); color:var(--text);
      padding:12px 16px; border-radius:12px; box-shadow:var(--shadow); z-index:5;
      transition: transform .3s ease, opacity .3s ease; opacity:0; pointer-events:none;
    }
    .toast.show{ transform:translateX(-50%) translateY(0); opacity:1 }

    /* === –º—è–≥–∫–∏–µ —á–∞—Å—Ç–∏—Ü—ã –Ω–∞ —Ñ–æ–Ω–µ === */
    .particles{
      position:fixed; inset:0; pointer-events:none; z-index:-1;
    }
    .p{ position:absolute; width:10px; height:10px; border-radius:50%;
        background:radial-gradient(circle at 30% 30%, #fff, rgba(255,255,255,0) 70%);
        opacity:.08; animation: floatY 10s ease-in-out infinite;
      }
    @keyframes floatY{
      0%{ transform:translateY(10px) }
      50%{ transform:translateY(-10px) }
      100%{ transform:translateY(10px) }
    }

    /* === welcome –ø–æ–ª–æ—Å–∞ === */
    .welcome{
      display:flex; align-items:center; gap:10px; margin:8px 0 2px; color:var(--muted); font-size:14px;
      opacity:.9;
    }
    .dot{
      width:8px; height:8px; border-radius:50%; background:var(--ok); box-shadow:0 0 16px var(--ok);
      animation: pulse 1.8s ease-in-out infinite;
    }
    @keyframes pulse{
      0%,100%{ transform:scale(1); opacity:.9 }
      50%{ transform:scale(1.2); opacity:1 }
    }

    /* –∞–¥–∞–ø—Ç–∏–≤ */
    @media (max-width:420px){
      .head{ flex-direction:column; align-items:flex-start }
      .foot{ flex-direction:column; align-items:flex-start }
    }
  </style>
</head>
<body>
  <div class="glow-bg"></div>
  <div class="particles" id="particles"></div>

  <div class="wrap">
    <div class="card">
      <div class="head">
        <div class="title">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <h1>–ú–∞–≥–∞–∑–∏–Ω ‚≠ê Stars</h1>
            <p class="sub">–í—ã–±–µ—Ä–∏ –ø–∞–∫–µ—Ç ‚Äî –±–æ—Ç –ø—Ä–∏—à–ª—ë—Ç –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã –≤ —á–∞—Ç</p>
          </div>
        </div>
        <div class="env" id="env">–ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è‚Ä¶</div>
      </div>

      <div class="welcome" id="welcome" style="display:none">
        <span class="dot"></span>
        <span id="welcomeText"></span>
      </div>

      <div class="grid">
        <div class="product" data-tilt>
          <span class="tag">–°—Ç–∞—Ä—Ç</span>
          <div class="title2">Premium Mini</div>
          <p class="desc">–†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç –±–∞–∑–æ–≤—ã–µ —Ñ–∏—á–∏.</p>
          <div class="row">
            <div class="price">5‚≠ê</div>
            <button class="btn" onclick="buy('buy_5')">–ö—É–ø–∏—Ç—å</button>
          </div>
        </div>

        <div class="product" data-tilt>
          <span class="tag">–¢–æ–ø –≤—ã–±–æ—Ä</span>
          <div class="title2">Premium Plus</div>
          <p class="desc">–ë–æ–ª—å—à–µ –ø–ª—é—à–µ–∫, –ª—É—á—à–∏–π value.</p>
          <div class="row">
            <div class="price">20‚≠ê</div>
            <button class="btn" onclick="buy('buy_20')">–ö—É–ø–∏—Ç—å</button>
          </div>
        </div>

        <div class="product" data-tilt>
          <span class="tag">–ú–∞–∫—Å</span>
          <div class="title2">Premium Ultra</div>
          <p class="desc">–í—Å—ë –∏ —Å—Ä–∞–∑—É. –ü–æ–¥–¥–µ—Ä–∂–∏ –ø—Ä–æ–µ–∫—Ç üíú</p>
          <div class="row">
            <div class="price">100‚≠ê</div>
            <button class="btn" onclick="buy('buy_100')">–ö—É–ø–∏—Ç—å</button>
          </div>
        </div>
      </div>

      <div class="foot">
        <span>üí° –û–ø–ª–∞—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —á–∞—Ç–µ —Å –±–æ—Ç–æ–º. –ú—ã –ø–æ–¥—Å–∫–∞–∂–µ–º –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏–º üëá</span>
        <span id="status" class="status"></span>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">–ì–æ—Ç–æ–≤–æ</div>

  <script>
    // === –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ===
    const BOT_USERNAME = "QlewetaBot"; // –±–µ–∑ @ ‚Äî –ø—Ä–æ–≤–µ—Ä—å —Ç–æ—á–Ω–æ!

    // === –æ–∫—Ä—É–∂–µ–Ω–∏–µ, –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ ===
    const envEl = document.getElementById('env');
    const statusEl = document.getElementById('status');
    const toastEl = document.getElementById('toast');
    const welcome = document.getElementById('welcome');
    const welcomeText = document.getElementById('welcomeText');

    const isWebApp = !!(window.Telegram && Telegram.WebApp);
    envEl.textContent = isWebApp ? "WebApp OK ‚úÖ" : "Not in Telegram ‚ùå";

    if (isWebApp) {
      Telegram.WebApp.ready();
      Telegram.WebApp.expand();

      // –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –∏–º–µ–Ω–µ–º –∏–∑ initData
      const u = Telegram.WebApp.initDataUnsafe?.user;
      if (u?.first_name) {
        welcomeText.textContent = `–ü—Ä–∏–≤–µ—Ç, ${u.first_name}!`;
        welcome.style.display = '';
      }

      // –ª—ë–≥–∫–∏–µ —Ö—ç–ø—Ç–∏–∫–∏
      try { Telegram.WebApp.HapticFeedback.impactOccurred('light'); } catch(e) {}

      // —Å—Ç–∞—Ç—É—Å –∑–∞–∫—Ä—ã—Ç–∏—è –∏–Ω–≤–æ–π—Å–∞
      Telegram.WebApp.onEvent('invoiceClosed', (d) => {
        if (!d || !d.status) return;
        if (d.status === 'paid') {
          statusEl.textContent = "‚úÖ –û–ø–ª–∞—Ç–∞ –ø—Ä–æ—à–ª–∞";
          statusEl.className = "status ok";
          showToast("–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–¥–¥–µ—Ä–∂–∫—É! ü´∂");
          confetti();
        } else if (d.status === 'cancelled') {
          statusEl.textContent = "‚ùå –û–ø–ª–∞—Ç–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞";
          statusEl.className = "status bad";
          showToast("–ü–ª–∞—Ç—ë–∂ –æ—Ç–º–µ–Ω—ë–Ω");
        } else {
          statusEl.textContent = "‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å";
          statusEl.className = "status";
        }
      });
    }

    // === —Ç–æ—Å—Ç ===
    function showToast(text){
      toastEl.textContent = text;
      toastEl.classList.add('show');
      setTimeout(()=>toastEl.classList.remove('show'), 2400);
    }

    // === –ø–ª–∞–≤–Ω—ã–π 3D-tilt –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ ===
    document.querySelectorAll('[data-tilt]').forEach(card=>{
      let r = card.getBoundingClientRect();
      function move(e){
        const x = (e.clientX - r.left) / r.width;
        const y = (e.clientY - r.top) / r.height;
        const rx = (0.5 - y) * 8;
        const ry = (x - 0.5) * 8;
        card.style.transform = `translateY(-3px) rotateX(${rx}deg) rotateY(${ry}deg)`;
      }
      function leave(){ card.style.transform = 'translateY(0) rotateX(0) rotateY(0)'; }
      card.addEventListener('mousemove', move);
      card.addEventListener('mouseleave', leave);
      window.addEventListener('resize', ()=>{ r = card.getBoundingClientRect(); });
    });

    // === —Ñ–æ–Ω–æ–≤—ã–µ —á–∞—Å—Ç–∏—Ü—ã ===
    (function particles(){
      const box = document.getElementById('particles');
      for (let i=0;i<16;i++){
        const b = document.createElement('div');
        b.className = 'p';
        const size = 6 + Math.random()*10;
        b.style.width = b.style.height = size + 'px';
        b.style.left = (Math.random()*100) + 'vw';
        b.style.top  = (Math.random()*100) + 'vh';
        b.style.animationDuration = (8 + Math.random()*6) + 's';
        box.appendChild(b);
      }
    })();

    // === –ø–µ—Ä–µ—Ö–æ–¥ –≤ —á–∞—Ç —Å –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º (deep-link) ===
    function goToChat(code){
      const https = `https://t.me/${BOT_USERNAME}?start=${encodeURIComponent(code)}`;
      const tguri = `tg://resolve?domain=${BOT_USERNAME}&start=${encodeURIComponent(code)}`;

      if (isWebApp && Telegram.WebApp.openTelegramLink) {
        Telegram.WebApp.openTelegramLink(https);
        return;
      }
      try { window.location.href = tguri; return; } catch(e){}
      window.location.href = https;
    }

    // === –ø–æ–∫—É–ø–∫–∞: –¥–≤–æ–π–Ω–æ–π —Ç—Ä–∏–≥–≥–µ—Ä (sendData + deep-link) ===
    function buy(code){
      if (!isWebApp) {
        alert("–û—Ç–∫—Ä–æ–π —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É –±–æ—Ç–∞ –≤ Telegram.");
        return;
      }

      // 1) –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–∫–∞–∑ –±–æ—Ç—É (–æ–Ω —Å—Ä–∞–∑—É –ø—Ä–∏—à–ª—ë—Ç –∏–Ω–≤–æ–π—Å –≤ —á–∞—Ç)
      try { Telegram.WebApp.sendData(code); } catch(e){ console.warn('sendData failed', e); }

      // 2) –ø–æ–ø–∞–ø ‚Äî —É–≤–æ–¥–∏–º –≤ —á–∞—Ç, –≥–¥–µ —É–∂–µ –∂–¥—ë—Ç –∏–Ω–≤–æ–π—Å
      Telegram.WebApp.showPopup({
        title: "–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ",
        message: "–°–µ–π—á–∞—Å –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —á–∞—Ç —Å –±–æ—Ç–æ–º, –≥–¥–µ –ø–æ—è–≤–∏—Ç—Å—è –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã.",
        buttons: [
          { id: "go", type: "default", text: "–ü–µ—Ä–µ–π—Ç–∏ –≤ —á–∞—Ç" },
          { type: "cancel" }
        ]
      }, (btnId)=>{ if (btnId === 'go') goToChat(code); });

      // –Ω–µ–±–æ–ª—å—à–æ–π —Ñ–∏–¥–±–µ–∫
      showToast("–û—Ç–∫—Ä—ã–≤–∞—é —á–∞—Ç –¥–ª—è –æ–ø–ª–∞—Ç—ã‚Ä¶");
      try { Telegram.WebApp.HapticFeedback.notificationOccurred('success'); } catch(e){}
    }

    // === –ª–µ–≥–∫–æ–µ –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –±–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫ ===
    function confetti(){
      const N = 20;
      for (let i=0;i<N;i++){
        const s = document.createElement('span');
        const size = 6 + Math.random()*6;
        const x = 50 + (Math.random()*40 - 20);
        const dur = 900 + Math.random()*700;
        s.style.cssText = `
          position:fixed; left:${x}vw; top: 40vh; width:${size}px; height:${size}px; 
          background: hsl(${Math.random()*360}, 85%, 60%); border-radius:2px;
          transform: translateY(-20vh) rotate(${Math.random()*180}deg);
          box-shadow:0 0 10px rgba(255,255,255,.25);
          pointer-events:none; z-index:6;
        `;
        document.body.appendChild(s);
        const angle = (Math.random()*2-1)*80;
        s.animate([
          { transform:`translateY(-20vh) rotate(0deg)` , opacity:1 },
          { transform:`translate(${angle}vw, 60vh) rotate(540deg)`, opacity:0.1 }
        ], { duration: dur, easing:'cubic-bezier(.17,.67,.27,1.18)' }).finished.then(()=> s.remove());
      }
    }
  </script>
</body>
</html>
